<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

  <head>
    <title>
      packages/pptpd/config – Freetz
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="/search" />
        <link rel="help" href="../../TracGuide.html" />
        <link rel="alternate" href="config%3Fformat=txt" type="text/x-trac-wiki" title="Reiner Text" />
        <link rel="up" href="../pptpd.html" title="Übergeordnete Wiki-Seite anzeigen" />
        <link rel="start" href="/wiki" />
        <link rel="stylesheet" href="../../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/wikiextras/css/phrases.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/wikiextras/css/boxes.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/wikiextras/css/boxes-300.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/wikiextras/css/boxes-narrow-toc.css" type="text/css" /><link rel="stylesheet" href="../../../wikicss.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/tags/css/tractags.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/wikinegotiator/css/langmenu-ctxnav.css" type="text/css" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="/favicon.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="/search/opensearch" title="Freetz durchsuchen" />
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/messages/de.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/folding.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="/wiki"><img src="../../../chrome/common/freetz_motd.png" alt="Freetz" /></a>
      </div>
      <form id="search" action="https://www.google.com/search" method="get" onsubmit="; this.elements.namedItem('q').value = this.elements.namedItem('oq').value + ' site:freetz.github.io'">
        <div>
          <label for="proj-search">Suche:</label>
          <input type="text" id="proj-search" name="oq" size="18" value="" />
          <input type="hidden" name="q" value="" />
          <input type="submit" value="Suche" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><li class="last"><a href="../../Impressum.html">Impressum</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="/wiki">Wiki</a></li><li><a href="https://github.com/Freetz/freetz/commits/master">Quellen durchsehen</a></li><li class="last"><a href="/screenshots">Bildschirmfotos</a></li>
    </ul>
  </div>
    <div id="langmenu"><ul><li class="first"><span title="Select a language of wiki content">Language:</span></li><li class=" active"><a class="" href="config.html" title="displaying language (default)">German</a></li><li class=" last"><a class=" notexist" href="/wiki/packages/pptpd/config.en" title="(not available)">English</a></li></ul></div><p /><div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="Zeige WikiStart an" href="/wiki">Wiki:</a><a class="pathentry" href="../../packages.html" title="Zeige packages an">packages</a><span class="pathentry sep">/</span><a class="pathentry" href="../pptpd.html" title="Zeige packages/pptpd an">pptpd</a><span class="pathentry sep">/</span><a class="pathentry" href="config.html" title="Zeige packages/pptpd/config an">config</a>
</div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">

          <div id="wikipage" class="trac-content"><h1 id="Konfiguration">Konfiguration</h1>
<p>
</p><div class="wiki-toc"><h4>Inhaltsverzeichnis</h4><ol><li><a href="../pptpd.html#PoPTop-PPTP-VPN-Server">PoPTop - PPTP-VPN-Server</a><ol><li><a href="../pptpd.html#WhatisPPTP">What is PPTP?</a></li><li><a href="../pptpd.html#WhatisPoptop">What is Poptop?</a></li></ol></li><li><a href="install.html#Installation">Installation</a><ol><li><a href="install.html#Kernel2.6Freetz">Kernel 2.6 (Freetz)</a></li><li><a href="install.html#Kernel2.4ds-mod">Kernel 2.4 (ds-mod)</a><ol><li><ol><li><a href="install.html#Vorbereitungen">Vorbereitungen</a></li></ol></li><li><a href="install.html#Patcheinspielen">Patch einspielen</a></li><li><a href="install.html#Kernelkonfigurierenundkompilieren">Kernel konfigurieren und kompilieren</a></li><li><a href="install.html#KompilierendesImagesvorbereitenunddurchführen">Kompilieren des Images vorbereiten und durchführen</a></li></ol></li></ol></li><li><a href="webif.html#DasWeb-FrontendzumPaket">Das Web-Frontend zum Paket</a><ol><li><a href="webif.html#Portweiterleitung">Portweiterleitung</a></li></ol></li><li class="active"><a href="config.html#Konfiguration">Konfiguration</a><ol><li class="active"><a href="config.html#pptpd.conf">pptpd.conf</a></li><li class="active"><a href="config.html#options.pptpd">options.pptpd</a></li><li class="active"><a href="config.html#chap-secrets">chap-secrets</a></li><li class="active"><a href="config.html#Troubleshooting">Troubleshooting</a></li><li class="active"><a href="config.html#TroubleshootingkeineFehlermeldung">Troubleshooting keine Fehlermeldung</a></li></ol></li></ol></div><p>
</p>
<p>
Die drei für Poptop relevanten Dateien können entweder über das <a class="wiki" href="webif.html">Webinterface</a> oder auf der Shell per vi editiert werden. Sie liegen im Verzeichnis <tt>/tmp/flash/ppp</tt>.
</p>
<h2 id="pptpd.conf">pptpd.conf</h2>
<p>
In der mitgelieferten Konfiguration ist logwtmp standardmäßig aktiviert (bezieht sich auf Version 1.1.2-stable. Ist im 'trunk' schon gefixed.). Dies sollte deaktiviert werden, da wtmp auf der fritzbox nicht läuft und somit eine vpn-Verbindung nicht zustande kommt.
</p>
<pre class="wiki"># TAG: logwtmp
#       Use wtmp(5) to record client connections and disconnections.
#
#logwtmp
</pre><p>
Falls die Datenrate vom Wlan ins Internet mit pptpd sehr langsam ist, sollte die Zeile <tt>bcrelay</tt> auskommentiert werden (siehe <a class="ext-link" href="http://www.ip-phone-forum.de/showthread.php?t=201539"><span class="icon">​</span>IPPF</a>)
</p>
<h2 id="options.pptpd">options.pptpd</h2>
<p>
In der Datei options.pptpd ist gegebenenfalls <tt>require-mppe-128</tt> eingetragen (bezieht sich auf Version 1.1.2-stable. Ist im 'trunk' schon gefixed.). Der pppd kennt diese Option aber nicht. Beim Aushandeln der Verschlüsselung per 'Auto' Einstellung im Client kann es unter Umständen zu Verbindungsproblemen kommen, wenn der Client erstmal verhandeln will (negotiation), der pppd aber direkt verschlüsselt sprechen will. Man kann die Verschlüsselung direkt auf 128 Bit fest einstellen. Mit dieser Einstellung hat eine PPTP Verbindung mit dem iPhone VPN-Client geklappt:
</p>
<pre class="wiki"># Require the peer to authenticate itself using MS-CHAPv2 [Microsoft
# Challenge Handshake Authentication Protocol, Version 2] authentication.
require-mschap-v2
# Require MPPE 128-bit encryption
# (note that MPPE requires the use of MSCHAP-V2 during authentication)
#require-mppe-128

mppe required,no40,no56,stateless
</pre><h2 id="chap-secrets">chap-secrets</h2>
<p>
In der <tt>options.pptpd</tt> ist der Name auf <tt>fritzbox</tt> eingestellt. Dies sollte sich dann in einem Benutzereintrag in der <tt>chap-secrets</tt> widerspiegeln:
</p>
<pre class="wiki"># client        server  secret                  IP addresses
username fritzbox password 192.168.x.y
EOF
</pre><p>
In vielen Beispielen im Netz steht in der zweiten Spalte <tt>pptpd</tt>. Möchte man das so haben, dann sollte man einfach den <tt>name</tt> Eintrag in <tt>options.pptpd</tt> entsprechend anpassen.
</p>
<h2 id="Troubleshooting">Troubleshooting</h2>
<p>
Um die pptpd Meldungen zu sehen, muss man zunächst einen syslogd starten:
</p>
<pre class="wiki">/var/tmp/flash/ppp # syslogd -L -C256 -l 7
</pre><p>
Und kann sich danach die Meldungen des daemons im syslog per <tt>logread</tt> anschauen:
</p>
<pre class="wiki">/var/tmp/flash/ppp # logread
</pre><p>
Um mehr Meldungen zu bekommen, kann man in <tt>options.pptpd</tt> und/oder <tt>pptpd.conf</tt> den Debug-Modus aktivieren:
</p>
<p>
options.pptpd:
</p>
<pre class="wiki"># Enable connection debugging facilities.
# (see your syslog configuration for where pppd sends to)
debug
</pre><p>
pptpd.conf:
</p>
<pre class="wiki"># TAG: debug
#       Turns on (more) debugging to syslog
#
debug
</pre><h2 id="TroubleshootingkeineFehlermeldung">Troubleshooting keine Fehlermeldung</h2>
<p>
Bei mir tauchte im log keine Fehlermeldung auf. Da hilft debuggen auf der Box mit:
</p>
<pre class="wiki">./strace pptpd -d -f -c /etc/ppp/pptpd.conf
</pre><p>
Dabei kam heraus, dass es folgende Fehlermeldung gibt:
</p>
<pre class="wiki">can't resolve symbol 'bzero'
</pre><p>
Dazu gibt es einen Thread im Forum, der letzte Post erklärt wie man die Toolchain zum fixen neu bauen muss:
<a class="ext-link" href="http://www.ip-phone-forum.de/showpost.php?p=1407147&amp;postcount=25"><span class="icon">​</span>http://www.ip-phone-forum.de/showpost.php?p=1407147&amp;postcount=25</a>
</p>
<p>
Update[18.07.11]: Das Problem sollte mit Freetz-1.2 bzw. einem aktuellen Trunk nicht mehr auftreten.
</p>
</div>

      </div>

    </div>
    </div>
  </body>
</html>
