<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

  <head>
    <title>
      packages/bftpd – Freetz
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="/search" />
        <link rel="help" href="../TracGuide.html" />
        <link rel="alternate" href="bftpd%3Fformat=txt" type="text/x-trac-wiki" title="Reiner Text" />
        <link rel="up" href="../packages.html" title="Übergeordnete Wiki-Seite anzeigen" />
        <link rel="start" href="/wiki" />
        <link rel="stylesheet" href="../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/phrases.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/boxes.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/boxes-300.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/boxes-narrow-toc.css" type="text/css" /><link rel="stylesheet" href="../../wikicss.css" type="text/css" /><link rel="stylesheet" href="../../chrome/tags/css/tractags.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikinegotiator/css/langmenu-ctxnav.css" type="text/css" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="/favicon.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="/search/opensearch" title="Freetz durchsuchen" />
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/messages/de.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/folding.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="/wiki"><img src="../../chrome/common/freetz_motd.png" alt="Freetz" /></a>
      </div>
      <form id="search" action="https://www.google.com/search" method="get" onsubmit="; this.elements.namedItem('q').value = this.elements.namedItem('oq').value + ' site:freetz.github.io'">
        <div>
          <label for="proj-search">Suche:</label>
          <input type="text" id="proj-search" name="oq" size="18" value="" />
          <input type="hidden" name="q" value="" />
          <input type="submit" value="Suche" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><li class="last"><a href="../Impressum.html">Impressum</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="/wiki">Wiki</a></li><li><a href="https://github.com/Freetz/freetz/commits/master">Quellen durchsehen</a></li><li class="last"><a href="/screenshots">Bildschirmfotos</a></li>
    </ul>
  </div>
    <div id="langmenu"><ul><li class="first"><span title="Select a language of wiki content">Language:</span></li><li class=" active"><a class="" href="bftpd.html" title="displaying language (default)">German</a></li><li class=" last"><a class=" notexist" href="/wiki/packages/bftpd.en" title="(not available)">English</a></li></ul></div><p /><div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="Zeige WikiStart an" href="/wiki">Wiki:</a><a class="pathentry" href="../packages.html" title="Zeige packages an">packages</a><span class="pathentry sep">/</span><a class="pathentry" href="bftpd.html" title="Zeige packages/bftpd an">bftpd</a>
</div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">

          <div id="wikipage" class="trac-content"><p>
</p><div class="wiki-toc"><h4>Inhaltsverzeichnis</h4><ol><li><a href="bftpd.html#ZusätzlicheBenutzereinrichten">Zusätzliche Benutzer einrichten</a></li><li><a href="bftpd.html#BestehendepersistenteBenutzermodifizieren">Bestehende (persistente) Benutzer modifizieren</a></li></ol></div><p>
</p>
<h1 id="Bftpd">Bftpd</h1>
<blockquote>
<p>
"The bftpd program is a small, easy-to-configure FTP server. It strives to be fast, secure and quick to install/configure." <a class="ext-link" href="http://bftpd.sourceforge.net/"><span class="icon">​</span>http://bftpd.sourceforge.net/</a>
</p>
</blockquote>
<p>
Bftpd ist ein kleiner FTP Server. Um den Zugriff auf den FTP-Server mit einem Passwort zu schützen, kann man wie folgt vorgehen:
</p>
<ul><li>Anonymer Zugriff auf der Freetz Konfigurations-Seite deaktivieren
</li><li>In einer Shell (serielle Konsole, telnet oder dropbear) das Passwort für den Benutzer ftp ändern:
<pre class="wiki">modpasswd ftp
</pre></li></ul><p>
Nun ist der Zugriff auf den FTP Server nur noch als Benutzer ftp mit dem vergebenen Passwort möglich.
</p>
<h2 id="ZusätzlicheBenutzereinrichten">Zusätzliche Benutzer einrichten</h2>
<p>
<img src="../../chrome/wikiextras-icons-16/exclamation.png" style="vertical-align: text-bottom" alt="/!\" /> Achtung: Der AVM-Dämon <tt>ctlmgr</tt> überschreibt die <tt>/etc/passwd</tt> bei Änderungen im Webinterface und löscht die angelegten User. Außerdem ist das Usermanagement von Freetz überarbeitet worden, so dass jetzt mit <tt>adduser username -h /var/media/ftp/uStor01</tt> neue Benutzer angelegt werden können. Diese Änderung muss anschließend mit <tt>modusers save; modsave flash</tt> persistent gemacht werden.
</p>
<p>
Über eine kleine Änderung in der <tt>debug.cfg</tt> oder mit <em>crond</em> können zusätzliche Benutzer mit frei wählbaren Homeverzeichnissen eingerichtet werden.
</p>
<p>
Auf dieser Seite kann man sich die für die <tt>/var/tmp/passwd</tt> benötigten Zeilen mit Benutzer und Passwort erzeugen lassen:
</p>
<pre class="wiki">http://home.flash.net/cgi-bin/pw.pl
</pre><p>
Alternativ geht das auch mit dem Unix/Linux Kommando <tt>htpasswd</tt>.
</p>
<p>
Die Syntax sieht dann wie folgt aus:
</p>
<pre class="wiki">echo "user1:pass1:1000:1:ftp user:/var/media/ftp:/bin/sh" &gt;&gt; /var/tmp/passwd
echo "user2:pass2:1000:1:ftp user:/var/media/ftp:/bin/sh" &gt;&gt; /var/tmp/passwd
echo "user3:pass3:1000:1:ftp user:/var/media/ftp/uStor01/share:/bin/sh" &gt;&gt; /var/tmp/passwd
</pre><p>
Wobei user und pass durch die zuvor zuvor erzeugten User und Passwörter zu ersetzen sind. Wie auch die Pfadangaben sind das natürlich nur Beispiele. Man beachte die Pfadangabe auf den USB-Stick im dritten Beispiel. Der Pfad muss natürlich zum Zeitpunkt des Logins existieren, sonst gibt es einen Fehler.
</p>
<p>
<em>Anmerkung: </em>
</p>
<ul><li>Das Passwort sollte nicht in der <tt>/etc/passwd</tt>, sondern in der <tt>/etc/shadow</tt> gespeichert werden. Das funktioniert auf der FritzBox, wie auf jeder üblichen Linux Distribution und ist im Internet an vielen Stellen dokumentiert.
</li><li>Die einzelnen Benutzer erhhalten fortlaufende Benutzer-IDs und nicht, wie hier, alle Benutzer die selbe ID (hier: 1000). Als group-ID kann/sollte man die 1 (= Gruppe "users") nehmen, anstelle der 0 (= Gruppe "root").
</li></ul><p>
Den AVM FTP benötigt ihr jetzt nicht mehr. Das Filesystem sollte auf Lesen und Schreiben ohne Passwörter eingestellt sein. Der bftpd sollte mit den Optionen "Automatisch starten lassen" und "nicht anonym" gestartet werden.
</p>
<h2 id="BestehendepersistenteBenutzermodifizieren">Bestehende (persistente) Benutzer modifizieren</h2>
<p>
Ergänzung von <a class="ext-link" href="http://www.ip-phone-forum.de/member.php?u=117253"><span class="icon">​</span>Alexander Kriegisch (kriegaex)</a> vom 13.10.2007:
</p>
<p>
Wie man im DS-Mod bis Version ds26-15.2 persistent Benutzer anlegt und löscht, erkläre ich in den <a class="wiki" href="../help/howtos/security/user_management.html">How-Tos</a>. Damit hat man also schon einmal automatisch angelegte Benutzer und Passwörter nach dem Hochfahren der Box. Die Passworteingabe erfolgt direkt an der Konsole, man braucht keine externe Seite, die das berechnet.
</p>
<p>
Jetzt geht es noch darum, dass das Heimverzeichnis eines Benutzers sowie seine UID (eindeutige numerische Benutzer-ID) automatisch jedesmal nach dem Neustart der Box vom DS-Mod vergeben werden, da sie bislang nicht persistent gespeichert werden (auch das wird sich zu 15.3 ändern). Wie man nun bestehende Benutzerdaten entsprechend automatisch umbiegt, beschreibe ich <a class="ext-link" href="http://www.ip-phone-forum.de/showthread.php?p=958801#post958801"><span class="icon">​</span>dort</a> im Forum.
</p>
</div>

      </div><ul class="tags"><li class="header">Tags</li><li><a href="/tags/daemons" rel="tag">daemons</a> </li><li><a href="/tags/filetransfer" rel="tag">filetransfer</a> </li><li><a href="/tags/ftp" rel="tag">ftp</a> </li><li><a href="../packages.html" rel="tag">packages</a> </li><li><a href="/tags/server" rel="tag">server</a> </li><li><a href="/tags/%C3%BCberarbeiten" rel="tag">überarbeiten</a> </li></ul>

    </div>
    </div>
  </body>
</html>
