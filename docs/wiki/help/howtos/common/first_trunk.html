<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      help/howtos/common/first_trunk – Freetz
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="http://freetz.org/search" />
        <link rel="help" href="../../../TracGuide.html" />
        <link rel="alternate" href="first_trunk%3Fformat=txt" type="text/x-trac-wiki" title="Reiner Text" />
        <link rel="up" href="../common.html" title="Übergeordnete Wiki-Seite anzeigen" />
        <link rel="start" href="http://freetz.org/wiki" />
        <link rel="stylesheet" href="../../../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/wikiextras/css/phrases.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/wikiextras/css/boxes.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/wikiextras/css/boxes-300.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/wikiextras/css/boxes-narrow-toc.css" type="text/css" /><link rel="stylesheet" href="../../../../wikicss.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/tags/css/tractags.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/wikinegotiator/css/langmenu-ctxnav.css" type="text/css" />
        <link rel="shortcut icon" href="http://freetz.org/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="http://freetz.org/favicon.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="http://freetz.org/search/opensearch" title="Freetz durchsuchen" />
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/messages/de.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/folding.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://freetz.org/wiki"><img src="../../../../chrome/common/freetz_motd.png" alt="Freetz" /></a>
      </div>
      <form id="search" action="http://freetz.org/search" method="get">
        <div>
          <label for="proj-search">Suche:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Suche" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="http://freetz.org/login">Anmelden</a></li><li><a href="http://freetz.org/prefs">Einstellungen</a></li><li><a href="../../../TracGuide.html">Hilfe/Anleitung</a></li><li><a href="http://freetz.org/about">Über Trac</a></li><li><a href="http://freetz.org/notification" title="Wiki Pages Change Notifications">My Notifications</a></li><li><a href="http://freetz.org/register">Registrieren</a></li><li class="last"><a href="../../../Impressum.html">Impressum</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="http://freetz.org/wiki">Wiki</a></li><li><a href="http://freetz.org/timeline">Journal</a></li><li><a href="http://freetz.org/roadmap">Projektplan</a></li><li><a href="http://freetz.org/browser">Quellen durchsehen</a></li><li><a href="http://freetz.org/report">Tickets anzeigen</a></li><li><a href="http://freetz.org/search">Suche</a></li><li><a href="http://freetz.org/tags">Tags</a></li><li><a href="http://freetz.org/downloads">Downloads</a></li><li class="last"><a href="http://freetz.org/screenshots">Bildschirmfotos</a></li>
    </ul>
  </div>
    <div id="langmenu"><ul><li class="first"><span title="Select a language of wiki content">Language:</span></li><li class=" active"><a class="" href="first_trunk..html" title="displaying language (default)">German</a></li><li class=" last"><a class=" notexist" href="http://freetz.org/wiki/help/howtos/common/first_trunk.en" title="(not available)">English</a></li></ul></div><div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="Zeige WikiStart an" href="http://freetz.org/wiki">Wiki:</a><a class="pathentry" href="../../../help.html" title="Zeige help an">help</a><span class="pathentry sep">/</span><a class="pathentry" href="../../howtos.html" title="Zeige help/howtos an">howtos</a><span class="pathentry sep">/</span><a class="pathentry" href="../common.html" title="Zeige help/howtos/common an">common</a><span class="pathentry sep">/</span><a class="pathentry" href="first_trunk.html" title="Zeige help/howtos/common/first_trunk an">first_trunk</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Kontext-Navigation</h2>
        <ul>
          <li class="first"><a href="../common.html">Aufwärts</a></li><li><a href="../../../WikiStart.html">Startseite</a></li><li><a href="../../../TitleIndex.html">Inhaltsverzeichnis</a></li><li><a href="first_trunk%3Faction=history.html">Änderungshistorie</a></li><li class="last"><a href="http://freetz.org/notification/help/howtos/common/first_trunk" title="Watch Page">Watch Page</a></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          <div id="wikipage" class="trac-content"><h1 id="Wiebaueichmeinenerstentrunk">Wie baue ich meinen ersten trunk ?</h1>
<p>
<h4>Inhaltsverzeichnis</h4>
    <ol>
      <li>
        <a href="first_trunk.html#BeschreibungfüreinTrunk-Imageinkl.SambaundVSFTP">Beschreibung für ein Trunk-Image inkl. Samba und VSFTP</a>
      </li>
      <li>
        <a href="first_trunk.html#Trunk-Imagebauen">Trunk-Image bauen</a>
        <ol>
          <li>
            <a href="first_trunk.html#Sambaeinrichten">Samba einrichten</a>
          </li>
          <li>
            <a href="first_trunk.html#FTP-FreigabeneinrichtenFreetz-Trunk">FTP-Freigaben einrichten (Freetz-Trunk)</a>
          </li>
          <li>
            <a href="first_trunk.html#EinrichtenvonBenutzern">Einrichten von Benutzern</a>
          </li>
          <li>
            <a href="first_trunk.html#RechtevergabefürFTP-User">Rechtevergabe für FTP-User</a>
          </li>
        </ol>
      </li>
      <li>
        <a href="first_trunk.html#ImagefüreinenSpeedportbauen">Image für einen Speedport bauen</a>
        <ol>
          <li>
            <a href="first_trunk.html#WelcheSpeedportslassensichmitFreetzmodifizieren">Welche Speedports lassen sich mit Freetz modifizieren?</a>
          </li>
          <li>
            <a href="first_trunk.html#UmbaueinesW701V">Umbau eines W701V</a>
          </li>
          <li>
            <a href="first_trunk.html#UmbaueinesW501V">Umbau eines W501V</a>
          </li>
          <li>
            <a href="first_trunk.html#UmbaueinesW920V">Umbau eines W920V</a>
          </li>
        </ol>
      </li>
    </ol>
<br />
</p>
<h2 id="BeschreibungfüreinTrunk-Imageinkl.SambaundVSFTP">Beschreibung für ein Trunk-Image inkl. Samba und VSFTP</h2>
<p>
Diese Anweisung ist für alle die geschrieben die zum ersten Mal Ihre Fritzbox mit einem FREETZ-Trunk (Entwickler-Version) modifizieren wollen.<br />
</p>
<h2 id="Trunk-Imagebauen">Trunk-Image bauen</h2>
<p>
Das Vorgehen um ein Trunk-Image zu bauen stimmt bis zum Punkt <strong>Freetz Sourcen auschecken</strong> mit den Schritten aus dem <a class="wiki" href="newbie.html">Newbie-Tutorial</a> überein. Deshalb steigt diese Anleitung erst an dieser Stelle ein. Falls ihr euch unsicher seid, dann geht das Tutorial nochmal bis zu <a class="wiki" href="newbie.html#FreetzSourcenauschecken">dieser Stelle</a> durch.
</p>
<p>
Der Befehl zum Auschecken sieht nun etwas anders aus. Folgender Befehl ist jetzt einzugeben: <br />  
</p>
<pre class="wiki">svn checkout http://svn.freetz.org/trunk freetz-trunk
</pre><p>
<br /> 
Sollte dies nicht starten, so kann es sein das die Netzwerkverbindung nicht funktioniert. In diesem Fall sollte ein <strong>ping 192.168.XXX.1</strong> über die Konsole Aufschluss geben, ob die Netzwerkverbindung funktioniert. Nun sollten die Freetz Quellen runtergeladen werden. Danach wechselt man in das Freetz Verzeichnis mit <strong>cd freetz-trunk</strong> und gibt dann ein <strong>make menuconfig</strong> ein. <br /> 
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/72?format=raw" title="auschecken von Freetz"><img src="http://freetz.org/screenshots/72?width=409&amp;format=raw&amp;height=325" alt="auschecken von Freetz" /></a><span class="description" style="width: 411px;">auschecken von Freetz</span></span></span>
Nach dieser Eingabe solltet Ihr folgendes Bild sehen: <br /> 
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/73?format=raw" title="menuconfig"><img src="http://freetz.org/screenshots/73?width=409&amp;format=raw&amp;height=325" alt="menuconfig" /></a><span class="description" style="width: 411px;">menuconfig</span></span></span> 
Dies ist wieder die Konfigurations-Oberfläche des Freetz-Buildsystems. Dort wählt ihr den jeweiligen Router und die gewünschten Pakete aus. Für dieses HowTo haben wir beispielhaft die 7270_v2 gewählt. Als erstes aktivieren wir die erweiterte Ansicht (<strong>Level of user competence</strong>&rarr;<strong>Advanced</strong>)  auf der ersten Seite. Danach sollten in einem Freetz-Image folgende Patches ausgewählt werden: <br />
<strong>Unter Firmware language:</strong><br />
</p>
<ul><li>Auswählen ob ihr eine Firmware de oder en Firmware erstellen wollt. (Achtung: Die Auswahl muss zur vorhandenen Box passen.)
</li></ul><p>
<strong>Unter Other patches:</strong><br />
</p>
<ul><li><strong>FREETZMOUNT</strong>
</li><li><strong>Automount Filesystems</strong>
<ul><li><strong>NTFS</strong>
</li></ul></li></ul><p>
<strong>Unter Removal patches</strong><br />
</p>
<ul><li><strong>Remove ftpd (NEW)</strong> (ein FTP-Programm auf der Box reicht)
</li></ul><p>
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/187?format=raw" title="Patches"><img src="http://freetz.org/screenshots/187?width=409&amp;format=raw&amp;height=325" alt="Patches" /></a><span class="description" style="width: 411px;">Patches</span></span></span>
<strong>Unter Packages/Standard packages:</strong><br />
</p>
<ul><li><strong>Samba suite</strong> (Server der den Zugriff auf die USB Medien an der FB von Windows erlaubt). Die Haken bei den beiden Unterpunkten von Samba smbd und nmbd müssen gesetzt werden.   
</li><li><strong>VSFTP</strong> (FTP-Server). Hier bitte keine weiteren Haken bei den Unterpunkten setzen. <br />
</li></ul><p>
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/186?format=raw" title="Patch : SAMB und VSFTP"><img src="http://freetz.org/screenshots/186?width=409&amp;format=raw&amp;height=325" alt="Patch : SAMB und VSFTP" /></a><span class="description" style="width: 411px;">Patch : SAMB und VSFTP</span></span></span> 
<strong>Unter Packages/ Web interfaces:</strong><br />
</p>
<ul><li><strong>AVM-firewall</strong> (Web-Oberfläche zum Administrieren der von AVM dem User vorenthaltene integrierten Firewall) 
</li><li><strong>spindown-cgi 0.2</strong>
</li><li><strong>Syslogd CGI 0.2.3</strong> 
</li></ul><p>
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/185?format=raw" title="Patche : Web interfaces"><img src="http://freetz.org/screenshots/185?width=409&amp;format=raw&amp;height=325" alt="Patche : Web interfaces" /></a><span class="description" style="width: 411px;">Patche : Web interfaces</span></span></span>
<strong>Unter Web Interface:</strong> <br />
</p>
<ul><li><strong>Favicons (none) &mdash;&rarr;</strong> einen Favicon auswählen. (Das ist das Bild was als Lesezeichen im Browser angezeigt wird)
</li></ul><p>
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/188?format=raw" title="Patch : Advanced options"><img src="http://freetz.org/screenshots/188?width=409&amp;format=raw&amp;height=325" alt="Patch : Advanced options" /></a><span class="description" style="width: 411px;">Patch : Advanced options</span></span></span><span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/228?format=raw" title=""><img src="http://freetz.org/screenshots/228?width=409&amp;format=raw&amp;height=325" alt="" /></a><span class="description" style="width: 411px;"></span></span></span>
Weitere Pakete und Patches incl. der Beschreibungen findet ihr auf der <a class="wiki" href="../../../packages.html">Paketseite</a> <br />  
<br />  
Nachdem alle Pakete und Patches ausgewählt sind, beendet man die Konfiguration und gibt auf der Kommandozeile der Shell Konsole <strong>make</strong> ein. Nun solltet ihr ein solches Bild sehen: <br />
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/189?format=raw" title="make ausführen"><img src="http://freetz.org/screenshots/189?width=409&amp;format=raw&amp;height=325" alt="make ausführen" /></a><span class="description" style="width: 411px;">make ausführen</span></span></span> 
Nun startet wieder der Erstellungsvorgang. Der Ablauf ist identisch zum ersten Image. Das erstellte Image wird wiederum im Unterordner <strong>images</strong> des Freetz Verzeichnisses abgelegt. <br />
<br />
Die Abschlussmeldung sieht wie folgt aus:
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/190?format=raw" title="make ist fertig "><img src="http://freetz.org/screenshots/190?width=409&amp;format=raw&amp;height=325" alt="make ist fertig " /></a><span class="description" style="width: 411px;">make ist fertig</span></span></span>
<br />
<br />
Die Schritte <strong>Image auf den PC kopieren</strong> und Flash-Vorgang sind wieder identisch zum <a class="wiki" href="newbie.html">Newbie-Tutorial</a>.
</p>
<h3 id="Sambaeinrichten">Samba einrichten</h3>
<p>
Samba muß zunächst eingerichtet werden. Hierfür geht man auf <strong>Pakete/Samba</strong>. Starttyp auf <strong>automatisch</strong> stellen und Netbios Name vergeben. Wichtig ist der Haken bei <strong>Bevorzugter Master</strong>, weil er den Standard Samba-Server der FritzBox ersetzt.  
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/192?format=raw" title="Freetz-WebIF"><img src="http://freetz.org/screenshots/192?width=409&amp;format=raw&amp;height=325" alt="Freetz-WebIF" /></a><span class="description" style="width: 411px;">Freetz-WebIF</span></span></span>  
<br /> 
Den Rest kann man so lassen und klickt auf <strong>Samba Freigaben</strong>.
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/193?format=raw" title="Freetz-WebIF"><img src="http://freetz.org/screenshots/193?width=409&amp;format=raw&amp;height=325" alt="Freetz-WebIF" /></a><span class="description" style="width: 411px;">Freetz-WebIF</span></span></span>
Wir haben hier nun 2 Freigaben auf der USB-HDD der FB beispielhaft erstellt, ein für <strong>Gast</strong> und die zweite für <strong>Familie</strong>. Hier eine kurze Beschreibung der Parameter anhand der ersten Freigabe: <br />  
</p>
<blockquote>
<p>
<strong>/var/media/ftp/uStor01</strong> dies ist der interner Pfad auf die Festplatte <br /> 
<strong>/Videos</strong> das ist das Freigegebenes Verzeichnis <br /> 
<strong>hdd1</strong> Name der Freigabe der in der Windows-Netzwerkumgebung als Freigabe angezeigt wird. <br /> 
<strong>1</strong> Gast-Zugang erlaubt, kein Benutzername und Passwort nötig <br /> 
<strong>0</strong> Schreib-Lesezugriff aktiviert <br />  
<strong>-</strong> Grund für das - ????? (Muß rein, Begründung folgt !) <br />  
<strong>Videos</strong> Kommentar<br />
</p>
</blockquote>
<p>
<strong>Beispiel:</strong>
</p>
<pre class="wiki">/var/media/ftp/uStor01/Videos hdd1 1 0 - Videos 
</pre><p>
Da wir als Netbiosname <strong>fritz</strong> vergeben hatte, lautet der Zugriff von Windows auf die Freigabe <br />fritz\hdd1 . <br /> 
Jetzt noch unter <strong>Dienste</strong> den Samba Server starten und dann sollte es funktionieren. 
<br />
<br />
</p>
<h3 id="FTP-FreigabeneinrichtenFreetz-Trunk">FTP-Freigaben einrichten (Freetz-Trunk)</h3>
<p>
<strong>Achtung! Diese Beschreibung beruht auf einem Trunk-Image. FTP-Freigaben für Freetz-1.1.x-Images werden später erklärt</strong> <br /> 
<br />  
Als erstes muss eine Order-Struktur auf der USB-Platte erzeugt werden. Dazu einfach euren USB-Stick oder Festplatte im Fat32 formatieren (NTFS würde auch gehen wird hier aber nicht näher beschrieben). <br /> 
Eure Platte sollte dann wie folgt aussehen : 
<span class="thumbnail"><span class="aux" style="width: 509px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/81?format=raw" title=""><img src="http://freetz.org/screenshots/81?width=507&amp;format=raw&amp;height=173" alt="" /></a><span class="description" style="width: 509px;"></span></span></span>   
Wenn das der Fall sein sollte könnt ihr den Stick (wir gehen im weiteren Verlauf dieser Beschreibung von einem Stick aus) an eure FritzBox stecken. <br />  
Nun wird, wenn noch nicht unter der Samba-Einrichtung erfolgt, die AVM-Lösungen von FTP abgeschaltet: <br />
</p>
<ul><li>fritz.box &rarr; Einstellungen &rarr; Erweiterte Einstellungen &rarr; USB-Geräte &rarr; USB-Speicher(Speicher(NAS) <br /> 
</li><li>USB-Speicher FTP-Zugriff aktivieren &rarr; Häkchen weg <br />  
</li><li>USB-Netzwerkspeicher aktivieren &rarr; Häkchen weg <br />
</li></ul><p>
Das sollte nun so aussehen: 
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/82?format=raw" title=""><img src="http://freetz.org/screenshots/82?width=409&amp;format=raw&amp;height=325" alt="" /></a><span class="description" style="width: 411px;"></span></span></span>  
Nun wechseln wir ins Freetz-Interface: <a class="ext-link" href="http://fritz.box:81/"><span class="icon">​</span>http://fritz.box:81/</a> und geben dort unter : &mdash;&gt; Dienste &mdash;&gt; vsftp folgende Sachen ein: <br />
</p>
<ul><li>Starttyp : Automatisch <br />
</li><li>Zugriff : Haken setzen bei <strong>Lokale Benutzer</strong> und <strong>chroot jail</strong> (alle anderen Haken raus) <br />
</li><li>Zusätzliche Konfigurationsoptionen (für Experten) : <strong>user_config_dir=/var/media/ftp/uStor01/vsftp_user_conf</strong> <br />
</li><li>Logging : <strong>/var/media/ftp/uStor01/vsftpd.log</strong> (kann man aktivieren, muß man aber nicht). <br />
</li></ul><p>
<br />  
Die ganzen Eingaben sollten nun mit dem Drücken des Button <strong>Übernehmen</strong> übernommen werden. Das sollte dann wie folgt aussehen:  
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/194?format=raw" title="Freetz-WebIF"><img src="http://freetz.org/screenshots/194?width=409&amp;format=raw&amp;height=325" alt="Freetz-WebIF" /></a><span class="description" style="width: 411px;">Freetz-WebIF</span></span></span>  
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/84?format=raw" title=""><img src="http://freetz.org/screenshots/84?width=409&amp;format=raw&amp;height=325" alt="" /></a><span class="description" style="width: 411px;"></span></span></span>  
Nun wenden wir uns der AVM-Firewall zu:
</p>
<ul><li>[&mdash;&gt;Pakete &mdash;&gt; AVM-Firewall und dort den Pkt. Forwarding). Hier muß noch der FTP-Port freigegeben werden (siehe Bilder).  
</li></ul><p>
<span class="thumbnail"><span class="aux" style="width: 819px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/85?format=raw" title=""><img src="http://freetz.org/screenshots/85?width=817&amp;format=raw&amp;height=202" alt="" /></a><span class="description" style="width: 819px;"></span></span></span>  
Nach eingabe der Zahlen (siehe Oben) einfach auf <strong>Hinzufügen</strong> drücken und das Ergenbins sollte wie Folgt aussehen: 
<span class="thumbnail"><span class="aux" style="width: 928px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/86?format=raw" title=""><img src="http://freetz.org/screenshots/86?width=926&amp;format=raw&amp;height=253" alt="" /></a><span class="description" style="width: 928px;"></span></span></span> 
Um diese Einstellung nun endgültig zu speichern einfach den Haken (Blinkendes Kästchen) setzen und den Reeboot der Box abwarten. <br /> 
Nachdem die Box nun wieder gestartet ist öffnen wir nochmals in der Freetz-Weboberfläche den Reiter <strong>Dienste</strong> und aktivieren den Dienst <strong>telnetd</strong>. Dieser muß gestartet sein um im nächsten Schritt dieser Anweisung die FTP-User einrichten zu können. Es wird nicht empfohlen diesen Dienst auf automatisch zu setzen sondern ihn bei Bedarf manuell zu starten. <br /> 
<br /> 
Nun verlassen wir für's erste die Web-Oberfläche und nähern uns der Kommandozeilenebene der FritzBox ! Dazu benötigen wir als erstes das Programm <a class="ext-link" href="http://putty.softonic.de/"><span class="icon">​</span>Putty</a> welches wir uns aus dem Netz laden und auf dem PC installieren. Dieser Schritt ist nur für Windows-User nötig. Linux-User können eine Telnet-Sitzung wie gewohnt starten. <br /> 
Putty kann man hier als Freeware laden :<a class="ext-link" href="http://putty.softonic.de/"><span class="icon">​</span>Download</a> und wird wie folgt eingestellt: 
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/87?format=raw" title=""><img src="http://freetz.org/screenshots/87?width=409&amp;format=raw&amp;height=325" alt="" /></a><span class="description" style="width: 411px;"></span></span></span> 
Nach drücken von <strong>Open</strong> und Eingabe folgender Daten <strong>login:root</strong> und <strong>Password:freetz</strong> solltet ihr folgendes Bild sehen:
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/88?format=raw" title=""><img src="http://freetz.org/screenshots/88?width=409&amp;format=raw&amp;height=325" alt="" /></a><span class="description" style="width: 411px;"></span></span></span> 
<br />
<br />
</p>
<h3 id="EinrichtenvonBenutzern">Einrichten von Benutzern</h3>
<p>
Der Befehl ist wie folgt aufgebaut: <tt>adduser -h '''Verzeichnis''' '''Benutzername'''</tt><br />
</p>
<blockquote>
<p>
<strong>Verzeichnis</strong>: Ordner auf dem Stick, der dem Benutzer zugeordnet werden soll, z.B. <strong>/var/media/ftp/uStor01/</strong> <br /> 
<strong>Benutzername</strong>: Name des Benutzers <br />
</p>
</blockquote>
<p>
Beim Erstellen des Benutzers wird danach gleich das Passwort abgefragt. Dieses muss zweimal eingegeben werden, und es wird dabei nichts am Bildschirm angezeigt, auch keine Sterne. <br />
Erzeugen wollen wir nun einen User <strong>Paul</strong> und eine Userin <strong>Mary</strong> welche auf die Ordner <strong>hdd1</strong>(Paul) und <strong>hdd2</strong>(Mary) (siehe Samba) FTP-Zugriff erhalten sollen. Weiterhin wird hier ein User <strong>Gast</strong> mit nur Leserechten auf dem Ordner <strong>hdd1</strong> erzeugt. <br /> 
Hierzu werden nun folgende Befehle in Putty eingegeben (Bitte auf Groß und Kleinschreibung achten): 
</p>
<pre class="wiki">/var/mod/root # adduser -h /var/media/ftp/uStor01/hdd1 paul
adduser: /var/media/ftp/uStor01/hdd1: Operation not permitted
Changing password for paul
New password:
Bad password: too short
Retype password:
Password for paul changed by root
</pre><p>
Die Meldung <tt>Operation not permitted</tt> kommt, wenn es sich um ein Dateisystem mit FAT oder NTFS handelt.<br />
Das selbe machen wir nun nochmals für Marry und Gast:
</p>
<pre class="wiki">  adduser -h /var/media/ftp/uStor01/hdd2 mary
  adduser -h /var/media/ftp/uStor01/hdd1 gast
</pre><p>
Wenn man das Paßwort ändern will, verwendet man dazu den Befehl <tt>passwd </tt><strong><tt>Benutzername</tt></strong>. Man wird dann wieder zweimal nach dem neuen Paßwort gefragt.<br />
Einen Benutzer löschen kann man mit dem Befehl <tt>deluser </tt><strong><tt>Benutzername</tt></strong>.<br />
In jedem Fall müssen die Änderungen mit dem Befehl <strong>modsave all</strong> wieder gespeichert werden.<br />
Anzeigen kann man die Datei mit dem Befehl <strong>cat /var/tmp/passwd</strong>. <br />
Anzeigen und Ändern ist auch möglich über die <a class="wiki" href="../../../packages/rudi-shell.html">Rudi-Shell</a> von Freetz. Diese ist nur verfügbar, wenn die <a class="wiki" href="../../../FAQ.html#KonfigurationinderaktuellenSicherheitsstufenichtverf%C3%BCgbar">Sicherheitsstufe</a> auf 0 gesetzt ist.<br />
Wenn alles Richtig gelaufen ist, sollte folgendes in der passwd stehen:
</p>
<pre class="wiki">root:x:0:0:root:/mod/root:/bin/sh
ftp:x:2:1:FTP account:/home/ftp:/bin/sh
ftpuser:x:1:1:ftp user:/var/media/ftp:/bin/sh
paul:x:1000:1000:Linux User,,,:/var/media/ftp/uStor01/hdd1:/bin/sh
mary:x:1001:1001:Linux User,,,:/var/media/ftp/uStor01/hdd2:/bin/sh
gast:x:1002:1002:Linux User,,,:/var/media/ftp/uStor01/hdd1:/bin/sh
</pre><p>
Nun melden wir uns noch mit folgendem Befehl von der Putty Konsole ab:<br />
</p>
<pre class="wiki">exit
</pre><p>
<br />
<br />
</p>
<h3 id="RechtevergabefürFTP-User">Rechtevergabe für FTP-User</h3>
<blockquote>
<p>
Ob ein Neuer FTP-User Schreibrechte erhalten soll oder nur lesen können soll wird wie folgt geregelt: <br /> Jeder Benutzer erhält eine Datei mit seinem Dateinamen im Ordner <strong>/var/media/ftp/uStor01/vsftp_user_conf/</strong>, die festlegt, ob er Schreibrechte hat oder nicht. <br /> 
</p>
</blockquote>
<p>
Inhalt der Datei :
</p>
<blockquote>
<p>
<strong>write_enable=yes</strong>(User hat Schreibrechte / siehe Paul und Mary)<br />
<strong>write_enable=no</strong>(User hat  <strong>keine</strong> Schreibrechte / siehe Gast)
</p>
</blockquote>
<p>
Über diese Benutzerdateien ist es auch möglich einzelne FTP-Befehle (<a class="ext-link" href="http://en.wikipedia.org/wiki/List_of_FTP_commands"><span class="icon">​</span>Liste</a>) für Benutzer zu verbieten. Hierzu fügt man folgende Zeile in die Datei ein und entfernt die Befehle die der User nicht ausführen darf:
</p>
<pre class="wiki">
cmds_allowed=ABOR,ACCT,ALLO,APPE,AUTH,CDUP,CWD,DELE,EPRT,EPSV,FEAT,HELP,LIST,MDTM,MKD,MODE,NLST,NOOP,OPTS,PASS,PASV,PBSZ,PORT,PROT,PWD,QUIT,REIN,REST,RETR,RMD,RNFR,RNTO,SITE,SMNT,STAT,STOR,STOU,STRU,SYST,TYPE,USER

</pre><p>
<strong>Beispiel:</strong> Mary darf Dateien auf den FTP kopieren und Verzeichnisse anlegen, jedoch diese nicht wieder löschen. Also muß folgendes in der Datei stehen:
</p>
<pre class="wiki">
cmds_allowed=ABOR,ACCT,ALLO,APPE,AUTH,CDUP,CWD,EPRT,EPSV,FEAT,HELP,LIST,MDTM,MKD,MODE,NLST,NOOP,OPTS,PASS,PASV,PBSZ,PORT,PROT,PWD,QUIT,REIN,REST,RETR,RNFR,RNTO,SITE,SMNT,STAT,STOR,STOU,STRU,SYST,TYPE,USER

</pre><blockquote>
<p>
<strong>DELE</strong> (Delete file), <strong>RMD</strong> (Remove a directory) wurden aus dem oben angegebenen String gelöscht. <br /> <br /> <br /> Sollte etwas immer noch nicht gehen, dann den Router einfach nochmal neu starten.
</p>
</blockquote>
<p>
<br />
<br />
</p>
<h2 id="ImagefüreinenSpeedportbauen">Image für einen Speedport bauen</h2>
<p>
Speedports lassen sich aufgrund einer Software-Sperre leider nicht per AVM-Webinterface flashen. Nutze die Freetz-Tools recover-eva oder push_firmware oder die GUI-Programme aus dem Forum wie z.B das <a class="ext-link" href="http://rukerneltool.rainerullrich.de/index.html"><span class="icon">​</span>ruKernelTool</a>. Dieses funktioniert sehr gut und ist einfach in der Bedienung.
</p>
<h3 id="WelcheSpeedportslassensichmitFreetzmodifizieren">Welche Speedports lassen sich mit Freetz modifizieren?</h3>
<ul><li><a class="wiki" href="first_trunk.html#UmbaueinesW501V">W501V </a>
</li><li><a class="wiki" href="first_trunk.html#UmbaueinesW701V">W701V </a>
</li><li><a class="wiki" href="first_trunk.html#UmbaueinesW701V">W900V </a>
</li><li><a class="wiki" href="first_trunk.html#UmbaueinesW920V">W920V </a>
</li></ul><h3 id="UmbaueinesW701V">Umbau eines W701V</h3>
<p>
1.) Freetz-Linux wie es oben beschrieben ist starten<br />
2.) Wir arbeiten alle Schritte ab wie im <a href="first_trunk.html">HowTo</a> beschrieben, jedoch bei Boxtyp
wählen wir die 7170 und stellen unter Alien hardware type den W701V aus.<br />
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/196?format=raw" title="Speedport_Trunk_2"><img src="http://freetz.org/screenshots/196?width=409&amp;format=raw&amp;height=325" alt="Speedport_Trunk_2" /></a><span class="description" style="width: 411px;">Speedport_Trunk_2</span></span></span>
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/197?format=raw" title="Speedport_Trunk_3"><img src="http://freetz.org/screenshots/197?width=409&amp;format=raw&amp;height=325" alt="Speedport_Trunk_3" /></a><span class="description" style="width: 411px;">Speedport_Trunk_3</span></span></span>
</p>
<p>
3.) Samba und VSFTP bringen nur was bei einem W920V (7570), da dieser einen USB-Port hat. Alle anderen Schritte in dem <a href="first_trunk.html">HowTo</a> passen jedoch auch bei einem Speedport.<br />
<br />
4.) Das erstellte Image sollte sich als normales FW-Update in die Box laden lassen. Sollte die Box den Update verweigern (war bei meinem W701V der Fall) bleibt Euch nur der Weg über das <a class="ext-link" href="http://rukerneltool.rainerullrich.de/index.html"><span class="icon">​</span>ruKernelTool</a>. Dann sind jedoch alle Zugangsdaten sowie alle Einstellungen verloren. Die Box macht in diesem Fall quasi einen Werksreset. <br />
<br />
<strong>Ergebnis:</strong>
<br />
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/195?format=raw" title="Speedport_Trunk_1"><img src="http://freetz.org/screenshots/195?width=409&amp;format=raw&amp;height=325" alt="Speedport_Trunk_1" /></a><span class="description" style="width: 411px;">Speedport_Trunk_1</span></span></span>
</p>
<h3 id="UmbaueinesW501V">Umbau eines W501V</h3>
<p>
Der W501V läßt sich direkt als Boxtyp auswählen
</p>
<h3 id="UmbaueinesW920V">Umbau eines W920V</h3>
<p>
Boxtyp: 7570 VDSL <br />
Alientyp:  W920V 
</p>
<p>
<span class="thumbnail"><span class="aux" style="width: 411px;"><a style="border-width: 1px;" href="http://freetz.org/screenshots/198?format=raw" title="Speedport_Trunk_4"><img src="http://freetz.org/screenshots/198?width=409&amp;format=raw&amp;height=325" alt="Speedport_Trunk_4" /></a><span class="description" style="width: 411px;">Speedport_Trunk_4</span></span></span>
</p>
</div>
          
          <div class="trac-modifiedby">
            <span><a href="first_trunk%3Faction=diff&amp;version=115.html" title="Version 115 von gismotro">zuletzt geändert</a> <a class="timeline" href="http://freetz.org/timeline?from=2014-07-06T16%3A50%3A46Z&amp;precision=second" title="Siehe Journal am 06.07.2014 16:50:46">vor 4 Jahren</a></span>
            <span class="trac-print">Zuletzt geändert am 06.07.2014 16:50:46</span>
          </div>
        
        
      </div><ul class="tags"><li class="header">Tags</li><li><a href="http://freetz.org/tags/howtos" rel="tag">howtos</a> </li></ul>
      

    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/chrome/screenshots/css/screenshots.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>In anderen Formaten herunterladen:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="first_trunk%3Fformat=txt">Reiner Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../../../../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Betrieben mit <a href="http://freetz.org/about"><strong>Trac 1.0.1</strong></a><br />
        von <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right"><div class="field" align="right"><form action="https://www.paypal.com/cgi-bin/webscr" method="post"><input type="hidden" name="cmd" value="_donations"/><input type="hidden" name="business" value="spenden@freetz.org"/><input type="hidden" name="item_name" value="Freetz Entwickler-Team"/><input type="hidden" name="no_shipping" value="1"/><input type="hidden" name="return" value="http://freetz.org"/><input type="hidden" name="cn" value="Name oder IPPF-Pseudonym"/><input type="hidden" name="currency_code" value="EUR"/><input type="hidden" name="tax" value="0"/><input type="hidden" name="lc" value="DE"/><input type="hidden" name="bn" value="PP-DonationsBF"/><input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="Zahlen Sie mit PayPal - schnell, kostenlos und sicher!"/><img alt="" border="0" src="http://freetz.org/pixel.gif" width="1" height="1"/></form></div></p>
    </div>
  </body>
</html>